{
  "id": "deny-001",
  "name": "Deny cluster deletion",
  "description": "Policy that explicitly denies the ability to delete any ROSA cluster. Often used as an additional guardrail attached to all users.",
  "source": "https://docs.openshift.com/rosa/rosa_architecture/rosa-sts-about-iam-resources.html",
  "policy": {
    "version": "v0",
    "statements": [
      {
        "sid": "DenyDeleteCluster",
        "effect": "Deny",
        "actions": [
          "rosa:DeleteCluster"
        ],
        "resources": [
          "*"
        ]
      }
    ]
  },
  "testCases": [
    {
      "description": "User cannot delete any cluster",
      "request": {
        "action": "rosa:DeleteCluster",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/any-cluster"
      },
      "expectedResult": "DENY"
    },
    {
      "description": "Even with admin policy, deletion is denied",
      "additionalPolicies": [
        {
          "version": "v0",
          "statements": [
            {
              "effect": "Allow",
              "Action": "rosa:*",
              "Resource": "*"
            }
          ]
        }
      ],
      "request": {
        "action": "rosa:DeleteCluster",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/prod-cluster"
      },
      "expectedResult": "DENY"
    },
    {
      "description": "Other operations are not affected",
      "request": {
        "action": "rosa:DescribeCluster",
        "resource": "arn:aws:rosa:us-west-2:111122223333:cluster/any-cluster"
      },
      "expectedResult": "NOT_EVALUATED"
    }
  ],
  "notes": "Explicit deny always wins over allow. This is typically combined with other allow policies to prevent accidental deletions."
}
